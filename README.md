# Near-by Eats

現在地から1.5km以内のレストランを検索・表示するシンプルな位置情報ベースのWebアプリケーションです。ブラウザの位置情報取得機能とGoogle Places APIを使用して、日本語UIでスムーズなレストラン検索体験を提供します。

## 🍽️ 主な機能

### 位置情報ベース検索
- **自動位置取得**: ブラウザのGeolocation APIを使用して現在地を自動取得
- **1.5km範囲検索**: 現在地から1.5km以内のレストランを検索
- **リアルタイム検索**: 位置情報取得後、即座にレストラン情報を表示

### レストラン情報表示
- **詳細情報**: レストラン名、評価、住所を見やすいカード形式で表示
- **レスポンシブデザイン**: モバイル・デスクトップ両対応のレイアウト
- **日本語UI**: 全てのインターフェースが日本語で統一

### エラーハンドリング
- **位置情報エラー**: 位置情報の取得失敗時に適切な日本語メッセージを表示
- **API エラー**: レストラン検索失敗時のエラーハンドリング
- **リトライ機能**: エラー発生時の再試行ボタン

### デモデータ機能
- **APIキー不要**: Google Maps APIキーが未設定でもデモデータで動作確認可能
- **開発支援**: 開発環境でのテストやデモンストレーションに最適

## 🛠️ 技術スタック

- **フロントエンド**: Next.js 14 (App Router), TypeScript, Tailwind CSS
- **バックエンド**: Next.js API Routes
- **外部API**: Google Places API, Browser Geolocation API
- **テスト**: Jest, React Testing Library
- **デプロイ**: Vercel

## 🚀 セットアップ手順

### 1. リポジトリのクローン
```bash
git clone <repository-url>
cd near-by-eats
```

### 2. 依存関係のインストール
```bash
npm install
```

### 3. 環境変数の設定

#### 開発環境
```bash
# .env.local ファイルを作成
cp .env.example .env.local
```

`.env.local` ファイルを編集：
```env
GOOGLE_MAPS_API_KEY=your_google_maps_api_key_here
```

#### Google Maps API キーの取得方法

1. **Google Cloud Console にアクセス**
   - [Google Cloud Console](https://console.cloud.google.com/) にログイン
   - 新しいプロジェクトを作成または既存プロジェクトを選択

2. **必要なAPIを有効化**
   - 「APIとサービス」→「ライブラリ」から以下のAPIを有効化：
     - **Places API** (必須)
     - Maps JavaScript API (将来の拡張用)

3. **APIキーを作成**
   - 「APIとサービス」→「認証情報」
   - 「認証情報を作成」→「APIキー」

4. **APIキーの制限設定（推奨）**
   ```
   アプリケーションの制限: HTTPリファラー
   許可するリファラー:
   - http://localhost:3000/*
   - https://your-domain.vercel.app/*
   
   APIの制限: Places API
   ```

### 4. 開発サーバーの起動
```bash
npm run dev
```

ブラウザで [http://localhost:3000](http://localhost:3000) を開いてアプリケーションを確認できます。

## 🧪 テスト

### テストの実行
```bash
# 全テストを実行
npm test

# ウォッチモードでテスト実行
npm run test:watch

# カバレッジレポート付きでテスト実行
npm run test:coverage
```

### テスト構成
- **単体テスト**: コンポーネントとAPI Routeの個別テスト
- **統合テスト**: 位置情報取得からレストラン表示までのフロー
- **エラーハンドリングテスト**: 各種エラーケースの確認

## 📱 デモデータ機能

Google Maps APIキーが設定されていない場合、アプリケーションは自動的にデモデータを使用します：

### デモレストラン一覧
- **和食レストラン 花月** (評価: 4.2/5)
- **イタリアン ベラヴィスタ** (評価: 4.0/5)  
- **カフェ & ビストロ 青空** (評価: 3.8/5)

### デモデータの特徴
- 実際のGoogle Places APIレスポンス形式に準拠
- 日本語のレストラン名と住所
- 営業時間や価格帯の情報も含む
- 開発・テスト・デモンストレーション用途に最適

## 🌐 デプロイ

### Vercel への自動デプロイ

このプロジェクトは **mainブランチへのpushで自動デプロイ** されるように設定されています。

#### 🚀 自動デプロイの流れ
1. **コード変更をmainブランチにプッシュ**
   ```bash
   git add .
   git commit -m "Update feature"
   git push origin main
   ```

2. **Vercelが自動的にデプロイを実行**
   - ビルドプロセスが自動開始
   - テストが成功すれば本番環境に反映
   - 通常2-3分でデプロイ完了

3. **プレビューデプロイ（プルリクエスト）**
   - フィーチャーブランチのプルリクエスト作成時
   - 自動的にプレビュー環境を生成
   - レビュー用の一意なURLが発行

#### 初回セットアップ手順
1. GitHubリポジトリにプッシュ
2. Vercelでリポジトリを連携
3. 環境変数 `GOOGLE_MAPS_API_KEY` を設定
4. 以降は自動デプロイが有効

詳細なデプロイ手順は [DEPLOYMENT.md](./DEPLOYMENT.md) を参照してください。

### 本番環境での確認事項
- [ ] 位置情報取得機能の動作
- [ ] Google Places API連携
- [ ] レスポンシブデザイン
- [ ] エラーハンドリング
- [ ] HTTPS での動作

## 🔧 開発コマンド

```bash
# 開発サーバー起動
npm run dev

# 本番ビルド
npm run build

# 本番サーバー起動
npm start

# リンター実行
npm run lint

# テスト実行
npm test

# テスト（ウォッチモード）
npm run test:watch

# テスト（カバレッジ）
npm run test:coverage
```

## 📁 プロジェクト構造

```
near-by-eats/
├── src/
│   ├── app/
│   │   ├── api/places/          # Places API エンドポイント
│   │   ├── __tests__/           # ページテスト
│   │   ├── globals.css          # グローバルスタイル
│   │   ├── layout.tsx           # アプリケーションレイアウト
│   │   └── page.tsx             # メインページ
│   ├── components/
│   │   ├── LocationButton.tsx   # 位置情報取得ボタン
│   │   ├── RestaurantCard.tsx   # レストラン表示カード
│   │   └── __tests__/           # コンポーネントテスト
│   └── types/
│       └── index.ts             # 型定義
├── .kiro/specs/                 # 仕様書・設計書
├── DEPLOYMENT.md                # デプロイメントガイド
├── vercel.json                  # Vercel設定
└── README.md                    # このファイル
```

## 🎯 使用方法

1. **アプリケーションにアクセス**
   - ブラウザでアプリケーションを開く

2. **位置情報の許可**
   - 「現在地を取得」ボタンをクリック
   - ブラウザの位置情報許可ダイアログで「許可」を選択

3. **レストラン検索**
   - 位置情報取得後、自動的に近くのレストランを検索
   - 1.5km以内のレストランがカード形式で表示

4. **結果の確認**
   - レストラン名、評価、住所を確認
   - 必要に応じて「再検索」ボタンで更新

## 🔒 セキュリティ

- **APIキー保護**: サーバーサイドでのみGoogle Maps APIキーを使用
- **HTTPS強制**: 本番環境では自動的にHTTPS化
- **リファラー制限**: APIキーにリファラー制限を設定推奨
- **位置情報**: ブラウザ内でのみ処理、サーバーに保存しない

## 🌍 アクセシビリティ

- **セマンティックHTML**: 適切なHTML要素を使用
- **キーボードナビゲーション**: Tab操作に対応
- **スクリーンリーダー**: aria-label等の適切な設定
- **カラーコントラスト**: WCAG準拠のコントラスト比

## 🤝 コントリビューション

1. このリポジトリをフォーク
2. フィーチャーブランチを作成 (`git checkout -b feature/amazing-feature`)
3. 変更をコミット (`git commit -m 'Add some amazing feature'`)
4. ブランチにプッシュ (`git push origin feature/amazing-feature`)
5. プルリクエストを作成

## 📄 ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 🆘 トラブルシューティング

### よくある問題

**Q: 位置情報が取得できない**
```
A: 以下を確認してください：
- HTTPSでアクセスしているか
- ブラウザの位置情報許可設定
- プライベートブラウジングモードでないか
```

**Q: レストランが表示されない**
```
A: 以下を確認してください：
- Google Maps APIキーが正しく設定されているか
- Places APIが有効化されているか
- APIキーの制限設定が適切か
```

**Q: デモデータが表示される**
```
A: これは正常な動作です：
- APIキーが未設定の場合、自動的にデモデータを表示
- 実際のデータを表示するにはAPIキーを設定してください
```

## 📞 サポート

問題や質問がある場合は、GitHubのIssuesページで報告してください。